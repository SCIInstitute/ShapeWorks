<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Shireen Elhabian et al.">
  <link rel="canonical" href="http://www.sci.utah.edu/software/shapeworks.html/api/Classes/classUtils.html">
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Utils - ShapeWorks</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <link href="../../css/custom.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Utils";
    var mkdocs_page_input_path = "api/Classes/classUtils.md";
    var mkdocs_page_url = "/software/shapeworks.html/api/Classes/classUtils.html";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/c++.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-36723568-3', 'mkdocs.org');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> ShapeWorks</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../index.html">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Getting Started</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../getting-started/shapes.html">Shapes, What & From Where?</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../getting-started/workflow.html">Shape Modeling Workflow</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../getting-started/sw-stories.html">ShapeWorks Success Stories</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../getting-started/interfaces.html">ShapeWorks Interfaces</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../getting-started/examples.html">Examples</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../getting-started/how-tos.html">How-Tos</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">For Users</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../users/install.html">How to Install ShapeWorks?</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../users/citation.html">How to Cite ShapeWorks?</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../users/papers.html">Revelant Papers</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Workflow</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflow/groom.html">How to Groom Your Dataset?</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflow/optimize.html">How to Optimize Your Shape Model?</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflow/analyze.html">How to Analyze Your Shape Model?</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">What is New?</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../new/new-studio.html">New in ShapeWorks Studio</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../new/openvdb.html">ShapeWorks Takes ~85% Less Memory</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../new/sw-meshes.html">ShapeWorks Directly on Meshes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../new/shapeworks-command.html">ShapeWorks Command</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../new/ssm-eval.html">Shape Model Evaluation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../new/shapeworks-python.html">ShapeWorks in Python</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../new/ellipsoid-joint-generation.html">Ellipsoid Joint Generation</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">ShapeWorks Tools</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../tools/ShapeWorksCommands.html">ShapeWorks Commands</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">ShapeWorks Studio</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../studio/getting-started-with-studio.html">Getting Started With ShapeWorks Studio</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../studio/multiple-domains.html">Multiple Domains SSM</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../studio/deepssm-in-studio.html">DeepSSM in Studio</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">ShapeWorks in Python</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../notebooks/getting-started-with-notebooks.html">Getting Started with Jupyter Notebooks</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../notebooks/getting-started-with-segmentations.html">Getting Started with Segmentations</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../notebooks/getting-started-with-meshes.html">Getting Started with Meshes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../notebooks/getting-started-with-exploring-segmentations.html">Getting Started with Exploring Segmentations</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../notebooks/getting-started-with-data-augmentation.html">Getting Started with Data Augmentation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../notebooks/getting-started-with-shape-cohort-generation.html">Getting Started with Shape Cohort Generator</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../notebooks/array-passing-without-copying.html">Array passing without copying</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../notebooks/create-and-apply-image-transforms.html">Transforms can be used to center image data or to align two images</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../notebooks/create-and-apply-mesh-transforms.html">Transforms can also be used to align two meshes</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Deep Learning & SSMs</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../deep-learning/pytorch-gpu.html">PyTorch GPU Support for ShapeWorks</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../deep-learning/data-augmentation.html">Data Augmentation for Deep Learning</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../deep-learning/deep-ssm.html">SSMs Directly from Images</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Use Cases</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../use-cases/use-cases.html">Getting Started with Use Cases</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Segmentation Based Use Cases</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../use-cases/segmentation-based/ellipsoid.html">Ellipsoid: Basic Example</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../use-cases/segmentation-based/left-atrium.html">Left Atrium: Shape Model from Segmentations</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../use-cases/segmentation-based/fixed-domain-ellipsoid.html">Fixed Domains Ellipsoid: Shape Model on New Shapes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../use-cases/segmentation-based/ellipsoid-multiple-domain.html">Shape Model for Multiple Domains from Segmentations</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Mesh Based Use Cases</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../use-cases/mesh-based/ellipsoid_mesh.html">Ellipsoid Mesh: Basic Example</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../use-cases/mesh-based/lumps.html">Lumps: Shape Model directly from Mesh</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../use-cases/mesh-based/thin-cavity-bean.html">Thin Cavity Bean: Shape Model with Geodesic Distances</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../use-cases/mesh-based/ellipsoid-multiple-domain-mesh.html">Shape Model for Multiple Domains directly from Mesh</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Contour Based Use Cases</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../use-cases/contour-based/supershapes-contour.html">Supershapes:Shape Model for Contour Domains</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Constraints Based Use Cases</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../use-cases/constraint-based/ellipsoid-cutting-planes.html">Ellipsoid: Shape Model with Cutting Planes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../use-cases/constraint-based/femur-cutting-planes.html">Femur:Shape Model with Cutting Planes</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Statistics Based Use Cases</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../use-cases/stats-based/ellipsoid-pca.html">Ellipsoid: Shape Statistics in Python</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../use-cases/stats-based/femur-pvalues.html">Femur: Group Difference Statistics in Python</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../use-cases/stats-based/ellipsoid-evaluate.html">Ellipsoid: Shape Evaluation in Python</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Deep Learning Based Use Cases</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../use-cases/deep-learning-based/deep-ssm-femur.html">Femur SSM Directly from Images</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../use-cases/right-ventricle.html">Right Ventricle: Highly Variable Shapes</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">For Developers</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/build.html">How to Build ShapeWorks from Source?</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/contribute.html">How to Contribute to ShapeWorks?</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/commands.html">How to Add ShapeWorks Commands?</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/python-apis.html">How to Add Python APIs?</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/tests.html">How to Add and Run Unit Tests?</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/new-use-case.html">How to Add New Use Cases?</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/datasets.html">How to Add New Datasets?</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/new-notebook.html">How to Add New Notebooks?</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/modify-datasets.html">When Modifying Existing Datasets</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/docs.html">Getting Started with Documentation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/gh-actions.html">Getting Started with GitHub Actions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/markdown.html">Getting Started with Markdown</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/paths.html">Adding to PATH Environment Variable</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">API Reference</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Modules/index_groups.html">Groups</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Namespaces/index_namespaces.html">Namespaces</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="index_classes.html">Classes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Files/index_files.html">Files</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">About</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../about/team.html">Meet ShapeWorkers!</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../about/release-notes.html">Release Notes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../about/license.html">License</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../about/contact.html">Contact Us</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">ShapeWorks</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
    
    <li>Utils</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/SCIInstitute/ShapeWorks/edit/master/docs/api/Classes/classUtils.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="utils">Utils</h1>
<h2 id="public-functions">Public Functions</h2>
<table>
<thead>
<tr>
<th></th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>std::vector&lt; int &gt;</td>
<td><strong><a href="classUtils.html#function-randperm">randperm</a></strong>(int n)</td>
</tr>
<tr>
<td>void</td>
<td><strong><a href="classUtils.html#function-readsparseshape">readSparseShape</a></strong>(vtkSmartPointer&lt; vtkPoints &gt; &amp; points, char * filename, int number_of_particles =-1)</td>
</tr>
<tr>
<td>void</td>
<td><strong><a href="classUtils.html#function-writesparseshape">writeSparseShape</a></strong>(char * filename, vtkSmartPointer&lt; vtkPoints &gt; particles)</td>
</tr>
<tr>
<td>void</td>
<td><strong><a href="classUtils.html#function-readsparseshape">readSparseShape</a></strong>(std::vector&lt; itk::Point&lt; double &gt; &gt; &amp; points, char * filename, int number_of_particles =-1)</td>
</tr>
<tr>
<td>void</td>
<td><strong><a href="classUtils.html#function-writesparseshape">writeSparseShape</a></strong>(char * filename, std::vector&lt; itk::Point&lt; double, 3 &gt; &gt; points)</td>
</tr>
<tr>
<td>std::vector&lt; int &gt;</td>
<td><strong><a href="classUtils.html#function-readparticleids">readParticleIds</a></strong>(char * filename)</td>
</tr>
<tr>
<td>void</td>
<td><strong><a href="classUtils.html#function-writeparticleids">writeParticleIds</a></strong>(char * filename, std::vector&lt; int &gt; ids)</td>
</tr>
<tr>
<td>void</td>
<td><strong><a href="classUtils.html#function-computecenterofmassforshapeensemble">computeCenterOfMassForShapeEnsemble</a></strong>(std::vector&lt; std::vector&lt; itk::Point&lt; double, 3 &gt; &gt; &gt; points_list, itk::Point&lt; double, 3 &gt; &amp; center)</td>
</tr>
<tr>
<td>void</td>
<td><strong><a href="classUtils.html#function-computecenterofmassforshape">computeCenterOfMassForShape</a></strong>(std::vector&lt; itk::Point&lt; double, 3 &gt; &gt; points, itk::Point&lt; double, 3 &gt; &amp; center)</td>
</tr>
<tr>
<td>void</td>
<td><strong><a href="classUtils.html#function-updatemin">updateMin</a></strong>(double curVal, double &amp; minVal)</td>
</tr>
<tr>
<td>void</td>
<td><strong><a href="classUtils.html#function-updatemax">updateMax</a></strong>(double curVal, double &amp; maxVal)</td>
</tr>
<tr>
<td>void</td>
<td><strong><a href="classUtils.html#function-getboundingboxforshapeensemble">getBoundingBoxForShapeEnsemble</a></strong>(std::vector&lt; std::vector&lt; itk::Point&lt; double, 3 &gt; &gt; &gt; points_list, double &amp; min_x, double &amp; min_y, double &amp; min_z, double &amp; max_x, double &amp; max_y, double &amp; max_z)</td>
</tr>
<tr>
<td>void</td>
<td><strong><a href="classUtils.html#function-getboundingboxforshape">getBoundingBoxForShape</a></strong>(std::vector&lt; itk::Point&lt; double, 3 &gt; &gt; points, double &amp; min_x, double &amp; min_y, double &amp; min_z, double &amp; max_x, double &amp; max_y, double &amp; max_z)</td>
</tr>
<tr>
<td>void</td>
<td><strong><a href="classUtils.html#function-spherical2cartesian">spherical2cartesian</a></strong>(const double inPoint[3], double outPoint[3])</td>
</tr>
<tr>
<td>void</td>
<td><strong><a href="classUtils.html#function-cartesian2spherical">cartesian2spherical</a></strong>(const double inPoint[3], double outPoint[3])</td>
</tr>
<tr>
<td>vtkSmartPointer&lt; vtkPoints &gt;</td>
<td><strong><a href="classUtils.html#function-converttophysicalcoordinates">convertToPhysicalCoordinates</a></strong>(vtkSmartPointer&lt; vtkPoints &gt; particles, int number_of_particles, const itk::Image&lt; float, 3 &gt;::SpacingType &amp; spacing, const itk::Image&lt; float, 3 &gt;::PointType &amp; origin)</td>
</tr>
<tr>
<td>vtkSmartPointer&lt; vtkPoints &gt;</td>
<td><strong><a href="classUtils.html#function-converttoimagecoordinates">convertToImageCoordinates</a></strong>(vtkSmartPointer&lt; vtkPoints &gt; particles, int number_of_particles, const itk::Image&lt; float, 3 &gt;::SpacingType &amp; spacing, const itk::Image&lt; float, 3 &gt;::PointType &amp; origin)</td>
</tr>
<tr>
<td>std::string</td>
<td><strong><a href="classUtils.html#function-num2str">num2str</a></strong>(float num)</td>
</tr>
<tr>
<td>std::string</td>
<td><strong><a href="classUtils.html#function-num2str">num2str</a></strong>(int num)</td>
</tr>
<tr>
<td>std::vector&lt; double &gt;</td>
<td><strong><a href="classUtils.html#function-linspace">linspace</a></strong>(double a, double b, size_t N)</td>
</tr>
<tr>
<td>std::string</td>
<td><strong><a href="classUtils.html#function-int2str">int2str</a></strong>(int n, int number_of_zeros)</td>
</tr>
<tr>
<td>template &lt;typename T > <br>void</td>
<td><strong><a href="classUtils.html#function-multiply-into">multiply_into</a></strong>(vnl_matrix&lt; T &gt; &amp; out, const vnl_matrix&lt; T &gt; &amp; lhs, const vnl_matrix&lt; T &gt; &amp; rhs)</td>
</tr>
<tr>
<td>double</td>
<td><strong><a href="classUtils.html#function-averagethetabruteforce">averageThetaBruteForce</a></strong>(std::vector&lt; double &gt; thetas, double dtheta)</td>
</tr>
<tr>
<td>double</td>
<td><strong><a href="classUtils.html#function-averagethetachord">averageThetaChord</a></strong>(std::vector&lt; double &gt; thetas)</td>
</tr>
<tr>
<td>double</td>
<td><strong><a href="classUtils.html#function-averagethetaarc">averageThetaArc</a></strong>(std::vector&lt; double &gt; thetas)</td>
</tr>
</tbody>
</table>
<h2 id="public-functions-documentation">Public Functions Documentation</h2>
<h3 id="function-randperm">function randperm</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">randperm</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="function-readsparseshape">function readSparseShape</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">readSparseShape</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">vtkSmartPointer</span><span class="o">&lt;</span><span class="w"> </span><span class="n">vtkPoints</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">points</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">filename</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">number_of_particles</span><span class="w"> </span><span class="o">=</span><span class="mi">-1</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="function-writesparseshape">function writeSparseShape</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">writeSparseShape</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">filename</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">vtkSmartPointer</span><span class="o">&lt;</span><span class="w"> </span><span class="n">vtkPoints</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">particles</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="function-readsparseshape_1">function readSparseShape</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">readSparseShape</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">itk</span><span class="o">::</span><span class="n">Point</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">points</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">filename</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">number_of_particles</span><span class="w"> </span><span class="o">=</span><span class="mi">-1</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="function-writesparseshape_1">function writeSparseShape</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">writeSparseShape</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">filename</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">itk</span><span class="o">::</span><span class="n">Point</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">points</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="function-readparticleids">function readParticleIds</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">readParticleIds</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">filename</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="function-writeparticleids">function writeParticleIds</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">writeParticleIds</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">filename</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">ids</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="function-computecenterofmassforshapeensemble">function computeCenterOfMassForShapeEnsemble</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">computeCenterOfMassForShapeEnsemble</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">itk</span><span class="o">::</span><span class="n">Point</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">points_list</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">itk</span><span class="o">::</span><span class="n">Point</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">center</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="function-computecenterofmassforshape">function computeCenterOfMassForShape</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">computeCenterOfMassForShape</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">itk</span><span class="o">::</span><span class="n">Point</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">points</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">itk</span><span class="o">::</span><span class="n">Point</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">center</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="function-updatemin">function updateMin</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">updateMin</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">curVal</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">minVal</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="function-updatemax">function updateMax</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">updateMax</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">curVal</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">maxVal</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="function-getboundingboxforshapeensemble">function getBoundingBoxForShapeEnsemble</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">getBoundingBoxForShapeEnsemble</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">itk</span><span class="o">::</span><span class="n">Point</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">points_list</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">min_x</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">min_y</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">min_z</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">max_x</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">max_y</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">max_z</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="function-getboundingboxforshape">function getBoundingBoxForShape</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">getBoundingBoxForShape</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="n">itk</span><span class="o">::</span><span class="n">Point</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">points</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">min_x</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">min_y</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">min_z</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">max_x</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">max_y</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">max_z</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="function-spherical2cartesian">function spherical2cartesian</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">spherical2cartesian</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">inPoint</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">outPoint</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="function-cartesian2spherical">function cartesian2spherical</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">cartesian2spherical</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">inPoint</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">outPoint</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="function-converttophysicalcoordinates">function convertToPhysicalCoordinates</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">vtkSmartPointer</span><span class="o">&lt;</span><span class="w"> </span><span class="n">vtkPoints</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">convertToPhysicalCoordinates</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">vtkSmartPointer</span><span class="o">&lt;</span><span class="w"> </span><span class="n">vtkPoints</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">particles</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">number_of_particles</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">itk</span><span class="o">::</span><span class="n">Image</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">float</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&gt;::</span><span class="n">SpacingType</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">spacing</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">itk</span><span class="o">::</span><span class="n">Image</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">float</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&gt;::</span><span class="n">PointType</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">origin</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="function-converttoimagecoordinates">function convertToImageCoordinates</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">vtkSmartPointer</span><span class="o">&lt;</span><span class="w"> </span><span class="n">vtkPoints</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">convertToImageCoordinates</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">vtkSmartPointer</span><span class="o">&lt;</span><span class="w"> </span><span class="n">vtkPoints</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">particles</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">number_of_particles</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">itk</span><span class="o">::</span><span class="n">Image</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">float</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&gt;::</span><span class="n">SpacingType</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">spacing</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">itk</span><span class="o">::</span><span class="n">Image</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">float</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&gt;::</span><span class="n">PointType</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">origin</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="function-num2str">function num2str</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">num2str</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">num</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="function-num2str_1">function num2str</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">num2str</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">num</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="function-linspace">function linspace</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">linspace</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">N</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="function-int2str">function int2str</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">int2str</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">number_of_zeros</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="function-multiply_into">function multiply_into</h3>
<div class="highlight"><pre><span></span><code><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="w"> </span><span class="o">&gt;</span><span class="w"></span>
<span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">multiply_into</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">vnl_matrix</span><span class="o">&lt;</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">out</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">vnl_matrix</span><span class="o">&lt;</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">lhs</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">vnl_matrix</span><span class="o">&lt;</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">rhs</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="function-averagethetabruteforce">function averageThetaBruteForce</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">averageThetaBruteForce</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">thetas</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">dtheta</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<p>Given a set of theta measurements, pick the "average" (approximately).</p>
<p>More formally, given a set of orientations, we wish to identify a "reference theta" such that the sum of the squared differences between each theta and the reference theta is minimized. This can be visualized: each theta (including the reference theta) can be mapped onto the unit circle): we wish to minimize the distance between the reference point and every other points by traveling along the circumference of the unit circle.</p>
<h2 id="approximate-chord-solution">APPROXIMATE CHORD SOLUTION</h2>
<p>This is hard, however, so instead of computing the distance along the circumference, we compute the distance along the chord.</p>
<p>This method is by <a href="mailto:ebolson@umich.edu">ebolson@umich.edu</a>, inspired by a similar problem in Horn's "closed-form solution of absolute orientation using unit
quaternions".</p>
<p>Let a be the set of input points, and R(a_i) represent a rotation of point a_i around the origin:</p>
<p>R(x) = [ cos(theta)<em>a_x - sin(theta)</em>a_y,] [ sin(theta)<em>a_x + cos(theta)</em>a_y ]</p>
<p>The error is:</p>
<p>X^2 = SUM ( R(a_i) - [1 0]' )' * (R(a_i) - [1 0]')</p>
<p>= SUM R'R - 2[1 0]R(a) + [1 0][1 0]'</p>
<p>Note that R'R is constant, because R and R' are orthogonal. (R'R = I). Dropping constant terms:</p>
<p>X^2 = SUM 2[1 0]R(a)</p>
<p>Differentiating with respect to theta:</p>
<p>dX^2/dtheta = SUM cos(theta)a_x - sin(theta)a_y = 0</p>
<p>Collecting cos and sin terms:</p>
<p>cos(theta) SUM a_x = sin(theta) SUM a_y</p>
<p>e.g.,:</p>
<p>theta = atan2( SUM a_y , SUM a_x )</p>
<h2 id="exact-solution">EXACT SOLUTION</h2>
<p>This solution runs in O(n log n).</p>
<p>Let us suppose that all of the input angles are mapped to [-PI, PI].</p>
<p>All the input points can be shifted to be within PI degrees of the reference angle by adding a multiple of 2PI degrees. If all the input angles are constrained to [-PI, PI], then we can find a reference angle [-PI, 2PI] such that all input points are within PI degrees by either adding 0 or exactly 2PI to individual input points.</p>
<p>More so, the input points that we must add 2PI to are the M points with the smallest theta, but we do not know M. This is necessary when the correct reference angle is large: the smallest points will be more than PI degrees away, so they need to be moved to the right side of the reference angle.</p>
<p>If we knew M, computing the reference angle is easy: it is simply the average of the (possibly shifted) input points. Let x[i] be the input point [-PI,PI] and y[i] be the possibly shifted version of that point, y[i] = x[i] + 2PI if i &lt; M, otherwise y[i] = x[i].</p>
<p>r = reference angle = (1 / N) * SUM_i y[i] error = SUM_i (y[i] - r)^2</p>
<p>We simply search over each value of M (from 0 to N), and recompute the error. Both the reference angle and error can be written in terms of the first and second moments of y[i], which gives us the following strategy:</p>
<p>1) Compute A1 and A2, the first and second moments of y[i], assuming M = 0. (This is just the first and second moments of x[i]). This involves iterating over each of the input points.</p>
<p>2) Considering the points in x[i] in sorted order, update A1 and A2 such that they reflect y[i] = x[i] + 2PI. Compute the new reference theta and error after every point (an O(1) operation) and report the theta whose error was the smallest.</p>
<p>Total run time is O(N log N) due to the sort operation. The other two passes are O(N). Memory usage is O(N), since all points must be stored so they can be sorted.</p>
<h2 id="summary">SUMMARY</h2>
<h2 id="method-runtime-memory-notes">method         runtime          memory         notes</h2>
<p>brute O(2PI*N / eps) O(N) worst-case error is eps/2 exact O(N log N) O(N) chord O(N) O(1) minimizes squared chord length, not squared arc length.</p>
<p>Real-world performance: the exact method is typically faster than the chord method, presumably because of the high cost of computing trigonometric functions used in the Chord method. This advantage decreases with larger number of points (due to the super-linear cost of sorting), but even at 50000 points, the optimal method is (a bit) faster than the chord method.</p>
<p>Reference: Olson, Edwin. "On computing the average orientation of vectors and lines." In Robotics and Automation (ICRA), 2011 IEEE International Conference on, pp. 3869-3874. IEEE, 2011.</p>
<p>Code is written in C++ from author's java implmentation by Shireen Elhabian - SCI institute, University of Utah </p>
<h3 id="function-averagethetachord">function averageThetaChord</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">averageThetaChord</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">thetas</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="function-averagethetaarc">function averageThetaArc</h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">averageThetaArc</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">thetas</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<hr />
<p>Updated on 2022-01-12 at 19:06:14 +0000</p>
              
            </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright  1998 - 2021 Scientific Computing and Imaging Institute. All rights reserved. This project is supported by the National Institutes of Health under grant numbers NIBIB-U24EB029011, NIAMS-R01AR076120, NHLBI-R01HL135568, NIBIB-R01EB016701, and NIGMS-P41GM103545. Software maintenance and support are provided within the funding period.</p>
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/SCIInstitute/ShapeWorks/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../assets/mathjaxhelper.js" defer></script>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6" defer></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
